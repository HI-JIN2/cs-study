# 가상화 기술과 Docker (0202)

## 1. 가상화 (Virtualization)

### 1) 개요
물리적 시스템 자원(서버, 스토리지, 네트워크)을 추상화하여, 하나의 물리적 컴퓨터에서 여러 가상 시스템을 효율적으로 실행하는 기술.

### 2) 가상화 방식 비교

#### 호스트 운영체제 가상화
*   하드웨어 > Host OS > 가상화 SW > Guest OS.
*   **특징**: Host OS 제약 없음, 사용 쉬움. 오버헤드 큼.
*   **예시**: VMware Workstation, VirtualBox.

#### 하이퍼바이저 가상화 (서버 가상화 주류)
*   하드웨어 > 하이퍼바이저 > VM (Guest OS).
*   **특징**: Host OS 없이 하드웨어 직접 제어(전가상화/반가상화). 성능 우수.
*   **예시**: Xen, KVM, Hyper-V, VMware ESX.

#### 컨테이너 가상화
*   하드웨어 > Host OS > 컨테이너 런타임 > 컨테이너(App + Lib).
*   **특징**:
    *   Guest OS가 없음 -> **매우 가볍고 빠름**.
    *   OS 커널을 공유하며 프로세스 수준에서 격리.
    *   이미지 크기가 작고 배포/이관이 쉬움.
*   **예시**: Docker, LXC, OpenVZ.

---

## 2. Docker 개요

### 1) 정의
*   **Docker**: 컨테이너형 가상화 기술을 구현하기 위한 오픈소스 플랫폼. Linux 컨테이너 기술의 사실상(de-facto) 표준.
*   **역할**: 애플리케이션과 실행 환경(라이브러리 등)을 하나로 패키징하여 격리된 환경에서 실행.

### 2) 기반 기술 (Linux Kernel)
Docker는 리눅스 커널의 기능을 이용하여 격리를 구현합니다.
*   **chroot**: 루트 디렉토리 격리.
*   **Namespace**: 프로세스, 네트워크, 파일 시스템, 사용자 ID 등 시스템 리소스 격리.
*   **cgroups (Control Groups)**: CPU, 메모리 등 자원 사용량 제한 및 격리.

### 3) Docker를 사용하는 이유
*   **환경 일관성**: "내 컴퓨터에서는 되는데 서버에서는 안 돼요" 문제 해결. (의존성 격리)
*   **효율성**: 가상 머신(VM) 대비 훨씬 가벼움.
*   **이식성**: 이미지만 있으면 어디서든 동일하게 실행 가능.

### 4) 주요 구성 요소
*   **Docker Engine**: 핵심 실행 환경.
*   **Docker Image**: 컨테이너를 생성하기 위한 읽기 전용 템플릿(설계도).
*   **Docker Container**: 이미지를 실행한 상태(인스턴스). 프로세스로 동작.
*   **Docker Hub**: 이미지 저장소(Registry).
*   **Docker Compose**: 다중 컨테이너 구성을 코드로 정의.

---

## 3. Docker 기본 명령어

### 1) 설치 (Ubuntu 예시)
```bash
sudo apt update
sudo apt install docker-ce docker-ce-cli containerd.io
sudo systemctl enable docker
sudo usermod -aG docker $(whoami) # sudo 없이 사용 설정
```

### 2) 컨테이너/이미지 명령어
*   `docker version`: 버전 확인.
*   `docker system df`: 디스크 사용량 확인.
*   `docker pull [이미지명]`: 이미지 다운로드.
*   `docker images`: 다운로드된 이미지 목록.
*   `docker run [이미지명]`: 컨테이너 생성 및 실행.
*   `docker ps`: 실행 중인 컨테이너 목록.
*   `docker ps -a`: 모든 컨테이너 목록(정지된 것 포함).
*   `docker stop [ID]`: 컨테이너 중지.
*   `docker rm [ID]`: 컨테이너 삭제.
*   `docker rmi [이미지ID]`: 이미지 삭제.

### 3) 실행 옵션 (`docker run`)
*   `-d`: 백그라운드 실행.
*   `-p [HostPort]:[ContainerPort]`: 포트 포워딩.
*   `--name [이름]`: 컨테이너 이름 지정.
*   `-it`: 대화형 터미널 모드 (컨테이너 내부 접속 시).
*   `--rm`: 종료 시 컨테이너 자동 삭제.
*   `-v`: 볼륨 마운트.

### 4) 실습 예시
```bash
# Nginx 웹 서버 실행 (8000포트로 접속)
docker run -d -p 8000:80 --name webserver nginx

# 컨테이너 내부 접속
docker exec -it webserver bash

# 로그 확인
docker logs -f webserver
```
